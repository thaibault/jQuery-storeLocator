#!/usr/bin/env node

// -*- coding: utf-8 -*-
'use strict';
/* !
    region header
    Copyright Torben Sickert (info["~at~"]torben.website) 16.12.2012

    License
    -------

    This library written by Torben Sickert stand under a creative commons naming
    3.0 unported license. see http://creativecommons.org/licenses/by/3.0/deed.de
    endregion
*/
// region imports

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _fs = require('fs');

var fileSystem = _interopRequireWildcard(_fs);

var _jsdom = require('jsdom');

var dom = _interopRequireWildcard(_jsdom);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _autoprefixer = require('autoprefixer');

var _autoprefixer2 = _interopRequireDefault(_autoprefixer);

var _postcssImport = require('postcss-import');

var _postcssImport2 = _interopRequireDefault(_postcssImport);

var _rimraf = require('rimraf');

var _webpack = require('webpack');

var _webpack2 = _interopRequireDefault(_webpack);

var _webpackSources = require('webpack-sources');

var _configurator = require('./configurator.compiled');

var _configurator2 = _interopRequireDefault(_configurator);

var _helper = require('./helper.compiled');

var _helper2 = _interopRequireDefault(_helper);

var _htmlLoader = require('html-loader');

var _htmlLoader2 = _interopRequireDefault(_htmlLoader);

var _loaderUtils = require('loader-utils');

var _loaderUtils2 = _interopRequireDefault(_loaderUtils);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

// NOTE: Only needed for debugging this file.
try {
    require('source-map-support/register');
} catch (error) {}

const plugins = require('webpack-load-plugins')();


plugins.HTML = plugins.html;
plugins.ExtractText = plugins.extractText;
plugins.AddAssetHtmlPlugin = require('add-asset-html-webpack-plugin');
plugins.OpenBrowser = plugins.openBrowser;
plugins.Favicon = require('favicons-webpack-plugin');
plugins.Imagemin = require('imagemin-webpack-plugin').default;
plugins.Offline = require('offline-plugin');

// / region monkey patches
// Monkey-Patch html loader to retrieve html loader options since the
// "webpack-html-plugin" doesn't preserve the original loader interface.


require.cache[require.resolve('html-loader')].exports = function () {
    _helper2.default.extendObject(true, this.options, module, this.options);
    return _htmlLoader2.default.apply(this, arguments);
};
// Monkey-Patch loader-utils to define which url is a local request.

const loaderUtilsIsUrlRequestBackup = _loaderUtils2.default.isUrlRequest;
require.cache[require.resolve('loader-utils')].exports.isUrlRequest = function (url) {
    if (url.match(/^[a-z]+:.+/)) return false;
    return loaderUtilsIsUrlRequestBackup.apply(_loaderUtils2.default, arguments);
};
// / endregion
// endregion
// region initialisation
let libraryName = _configurator2.default.exportFormat === 'var' ? _helper2.default.convertToValidVariableName(_configurator2.default.name) : _configurator2.default.name;
// // region plugins
const pluginInstances = [new _webpack2.default.optimize.OccurrenceOrderPlugin(true)];
// /// region generate html file
let htmlAvailable = false;
if (_configurator2.default.givenCommandLineArguments[2] !== 'buildDLL') for (const htmlConfiguration of _configurator2.default.files.html) try {
    fileSystem.accessSync(htmlConfiguration.template.substring(htmlConfiguration.template.lastIndexOf('!') + 1), fileSystem.F_OK);
    pluginInstances.push(new plugins.HTML(htmlConfiguration));
    htmlAvailable = true;
} catch (error) {}
// /// endregion
// /// region generate favicons
if (htmlAvailable && _configurator2.default.favicon) {
    let faviconAvailable = false;
    try {
        fileSystem.accessSync(_configurator2.default.favicon.logo, fileSystem.F_OK);
        faviconAvailable = true;
    } catch (error) {} finally {
        if (faviconAvailable) pluginInstances.push(new plugins.Favicon(_configurator2.default.favicon));
    }
}
// /// endregion
// /// region provide offline functionality
if (htmlAvailable && _configurator2.default.offline) {
    if (_configurator2.default.inPlace.cascadingStyleSheet) _configurator2.default.offline.excludes.push(`${ _configurator2.default.path.asset.cascadingStyleSheet }*.css?` + `${ _configurator2.default.hashAlgorithm }=*`);
    if (_configurator2.default.inPlace.javaScript) _configurator2.default.offline.excludes.push(`${ _configurator2.default.path.asset.javaScript }*.js?` + `${ _configurator2.default.hashAlgorithm }=*`);
    pluginInstances.push(new plugins.Offline(_configurator2.default.offline));
}
// /// endregion
// /// region opens browser automatically
if (_configurator2.default.development.openBrowser && htmlAvailable && ['serve', 'testInBrowser'].includes(_configurator2.default.givenCommandLineArguments[2])) pluginInstances.push(new plugins.OpenBrowser(_configurator2.default.development.openBrowser));
// /// endregion
// /// region provide build environment
pluginInstances.push(new _webpack2.default.DefinePlugin(_configurator2.default.buildDefinition));
// /// endregion
// /// region modules/assets
const moduleLocations = _helper2.default.determineModuleLocations(_configurator2.default.injection.internal, _configurator2.default.module.aliases, _configurator2.default.knownExtensions, _configurator2.default.path.context, _configurator2.default.path.ignore);
// //// region extract cascading style sheets
pluginInstances.push(new plugins.ExtractText(_configurator2.default.files.cascadingStyleSheet, {
    allChunks: true, disable: !_configurator2.default.files.cascadingStyleSheet }));
// //// endregion
// //// region perform javaScript minification/optimisation
if (_configurator2.default.module.optimizer.uglifyJS) pluginInstances.push(new _webpack2.default.optimize.UglifyJsPlugin(_configurator2.default.module.optimizer.uglifyJS));
// //// endregion
// //// region apply module pattern
pluginInstances.push({ apply: compiler => {
        compiler.plugin('emit', (compilation, callback) => {
            for (const request in compilation.assets) if (compilation.assets.hasOwnProperty(request)) {
                const filePath = request.replace(/\?[^?]+$/, '');
                const type = _helper2.default.determineAssetType(filePath, _configurator2.default.build, _configurator2.default.path);
                if (type && _configurator2.default.assetPattern[type] && !new RegExp(_configurator2.default.assetPattern[type].excludeFilePathRegularExpression).test(filePath)) {
                    const source = compilation.assets[request].source();
                    if (typeof source === 'string') compilation.assets[request] = new _webpackSources.RawSource(_configurator2.default.assetPattern[type].pattern.replace(/\{1\}/g, source.replace(/\$/g, '$$$')));
                }
            }
            callback();
        });
    } });
// //// endregion
// //// region in-place configured assets in the main html file
if (htmlAvailable && !['serve', 'testInBrowser'].includes(_configurator2.default.givenCommandLineArguments[2])) pluginInstances.push({ apply: compiler => {
        compiler.plugin('emit', (compilation, callback) => {
            if (_configurator2.default.files.html[0].filename in compilation.assets && (_configurator2.default.inPlace.cascadingStyleSheet || _configurator2.default.inPlace.javaScript)) dom.env(compilation.assets[_configurator2.default.files.html[0].filename].source(), (error, window) => {
                if (_configurator2.default.inPlace.cascadingStyleSheet) {
                    const urlPrefix = _configurator2.default.files.cascadingStyleSheet.replace('[contenthash]', '');
                    const domNode = window.document.querySelector(`link[href^="${ urlPrefix }"]`);
                    if (domNode) {
                        let asset;
                        for (asset in compilation.assets) if (asset.startsWith(urlPrefix)) break;
                        const inPlaceDomNode = window.document.createElement('style');
                        inPlaceDomNode.textContent = compilation.assets[asset].source();
                        domNode.parentNode.insertBefore(inPlaceDomNode, domNode);
                        domNode.parentNode.removeChild(domNode);
                        /*
                            NOTE: This doesn't prevent webpack from
                            creating this file if present in another chunk
                            so removing it (and a potential source map
                            file) later in the "done" hook.
                        */
                        delete compilation.assets[asset];
                    } else console.warn('No referenced cascading style sheet file in' + ' resulting markup found with ' + `selector: link[href^="${ urlPrefix }"]`);
                }
                if (_configurator2.default.inPlace.javaScript) {
                    const urlPrefix = _configurator2.default.files.javaScript.replace('[hash]', '');
                    const domNode = window.document.querySelector(`script[src^="${ urlPrefix }"]`);
                    if (domNode) {
                        let asset;
                        for (asset in compilation.assets) if (asset.startsWith(urlPrefix)) break;
                        domNode.textContent = compilation.assets[asset].source();
                        domNode.removeAttribute('src');
                        /*
                            NOTE: This doesn't prevent webpack from
                            creating this file if present in another chunk
                            so removing it (and a potential source map
                            file) later in the "done" hook.
                        */
                        delete compilation.assets[asset];
                    } else console.warn('No referenced javaScript file in resulting ' + 'markup found with selector: ' + `script[src^="${ urlPrefix }"]`);
                }
                compilation.assets[_configurator2.default.files.html[0].filename] = new _webpackSources.RawSource(compilation.assets[_configurator2.default.files.html[0].filename].source().replace(/^(\s*<!doctype[^>]+?>\s*)[\s\S]*$/i, '$1') + window.document.documentElement.outerHTML);
                callback();
            });else callback();
        });
        compiler.plugin('after-emit', (compilation, callback) => {
            if (_configurator2.default.files.html[0].filename in compilation.assets) {
                if (_configurator2.default.inPlace.cascadingStyleSheet) (0, _rimraf.sync)(_path2.default.join(_configurator2.default.path.asset.target, _configurator2.default.path.asset.cascadingStyleSheet), { glob: false });
                if (_configurator2.default.inPlace.javaScript) {
                    const assetFilePath = _path2.default.join(_configurator2.default.path.asset.target, _configurator2.default.files.javaScript.replace(`?${ _configurator2.default.hashAlgorithm }=[hash]`, ''));
                    for (const filePath of [assetFilePath, `${ assetFilePath }.map`]) try {
                        fileSystem.unlinkSync(filePath);
                    } catch (error) {}
                    const javaScriptPath = _path2.default.join(_configurator2.default.path.asset.target, _configurator2.default.path.asset.javaScript);
                    if (fileSystem.readdirSync(javaScriptPath).length === 0) fileSystem.rmdirSync(javaScriptPath);
                }
            }
            callback();
        });
    } });
// //// endregion
const injection = _helper2.default.resolveInjection(_configurator2.default.injection, _helper2.default.resolveBuildConfigurationFilePaths(_configurator2.default.build, _configurator2.default.path.asset.source, _configurator2.default.path.context, _configurator2.default.path.ignore), _configurator2.default.testInBrowser.injection.internal, _configurator2.default.module.aliases, _configurator2.default.knownExtensions, _configurator2.default.path.context, _configurator2.default.path.ignore);
let javaScriptNeeded = false;
const normalizedInternalInjection = _helper2.default.normalizeInternalInjection(injection.internal);
// //// region remove chunks if a corresponding dll package exists
if (_configurator2.default.givenCommandLineArguments[2] !== 'buildDLL') for (const chunkID in normalizedInternalInjection) if (normalizedInternalInjection.hasOwnProperty(chunkID) && _configurator2.default.dllManifestFilePaths.includes(`${ _configurator2.default.path.target }${ chunkID }.dll-manifest.json`)) {
    delete normalizedInternalInjection[chunkID];
    let sourceMapExists = false;
    // TODO replace all placeholder like "[id]", "[ext]", "[hash]" and
    // everywhere else
    const fileName = _configurator2.default.files.javaScript.replace(/^(.+)(?:\?[^?]*)$/, '$1').replace(/\[name\]/g, chunkID);
    try {
        fileSystem.accessSync(`${ _configurator2.default.path.target }${ fileName }.map`, fileSystem.F_OK);
        sourceMapExists = true;
    } catch (error) {}
    pluginInstances.push(new plugins.AddAssetHtmlPlugin({
        filename: `${ _configurator2.default.path.target }${ fileName }`,
        includeSourcemap: sourceMapExists
    }));
    pluginInstances.push(new _webpack2.default.DllReferencePlugin({
        context: _configurator2.default.path.context, manifest: require(`${ _configurator2.default.path.target }${ chunkID }.dll-manifest.json`)
    }));
}
// //// endregion
// //// region generate common chunks
if (_configurator2.default.givenCommandLineArguments[2] !== 'buildDLL') for (const chunkID of _configurator2.default.injection.commonChunkIDs) if (normalizedInternalInjection.hasOwnProperty(chunkID)) pluginInstances.push(new _webpack2.default.optimize.CommonsChunkPlugin({
    async: false,
    children: false,
    filename: _configurator2.default.files.javaScript,
    minChunks: Infinity,
    name: chunkID,
    minSize: 0
}));
// //// endregion
// //// region mark empty javaScript modules as dummy
for (const chunkName in normalizedInternalInjection) if (normalizedInternalInjection.hasOwnProperty(chunkName)) for (const moduleID of normalizedInternalInjection[chunkName]) {
    const type = _helper2.default.determineAssetType(_helper2.default.determineModuleFilePath(moduleID, _configurator2.default.module.aliases, _configurator2.default.knownExtensions, _configurator2.default.path.context), _configurator2.default.build, _configurator2.default.path);
    if (type && _configurator2.default.build[type] && _configurator2.default.build[type].outputExtension === 'js') {
        javaScriptNeeded = true;
        break;
    }
}
if (!javaScriptNeeded) _configurator2.default.files.javaScript = _path2.default.join(_configurator2.default.path.asset.javaScript, '.__dummy__.compiled.js');
// //// endregion
// //// region performs implicit external logic
if (injection.external === '__implicit__')
    /*
        We only want to process modules from local context in library mode,
        since a concrete project using this library should combine all assets
        (and deduplicate them) for optimal bundling results. NOTE: Only native
        javaScript and json modules will be marked as external dependency.
    */
    injection.external = (context, request, callback) => {
        const filePath = _helper2.default.determineModuleFilePath(request.substring(request.lastIndexOf('!') + 1), _configurator2.default.module.aliases, _configurator2.default.knownExtensions, context);
        if (filePath.endsWith('.js') || filePath.endsWith('.json')) {
            // NOTE: We apply alias on externals additionally.
            _helper2.default.applyAliases(request.substring(request.lastIndexOf('!') + 1), _configurator2.default.module.aliases);
            if (request.match(/^webOptimizer\/browserAPI(?:\.compiled)?(?:\.js)?/))
                /*
                    NOTE: The browser api needs processing since there exists
                    needed compile flags to avoid loading a complete node
                    browser api into a real browser.
                */
                return callback();
            for (const chunkName in normalizedInternalInjection) if (normalizedInternalInjection.hasOwnProperty(chunkName)) for (const moduleID of normalizedInternalInjection[chunkName]) if (_helper2.default.determineModuleFilePath(moduleID, _configurator2.default.module.aliases, _configurator2.default.knownExtensions, context) === filePath) return callback();
            if (!_path2.default.resolve(filePath).startsWith(_configurator2.default.path.context) || _helper2.default.isFilePathInLocation(filePath, _configurator2.default.path.ignore) && !_configurator2.default.inPlace.externalLibrary) {
                if (_configurator2.default.exportFormat === 'var') request = _helper2.default.convertToValidVariableName(request);
                return callback(null, `${ _configurator2.default.exportFormat } ${ request }`);
            }
        }
        return callback();
    };
// //// endregion
// //// region build dll packages
if (_configurator2.default.givenCommandLineArguments[2] === 'buildDLL') {
    let dllChunkIDExists = false;
    for (const chunkID in normalizedInternalInjection) if (normalizedInternalInjection.hasOwnProperty(chunkID)) if (_configurator2.default.injection.dllChunkIDs.includes(chunkID)) dllChunkIDExists = true;else delete normalizedInternalInjection[chunkID];
    if (dllChunkIDExists) {
        libraryName = '[name]DLLPackage';
        pluginInstances.push(new _webpack2.default.DllPlugin({
            path: `${ _configurator2.default.path.target }[name].dll-manifest.json`,
            name: libraryName
        }));
    } else throw Error('No dll chunk id found.');
}
// //// endregion
// /// endregion
// /// region apply final dom modifications/fixes
if (htmlAvailable) pluginInstances.push({ apply: compiler => {
        compiler.plugin('emit', (compilation, callback) => {
            if (_configurator2.default.files.html[0].filename in compilation.assets) dom.env(compilation.assets[_configurator2.default.files.html[0].filename].source(), (error, window) => {
                const linkables = {
                    script: 'src', link: 'href' };
                for (const tagName in linkables) if (linkables.hasOwnProperty(tagName)) for (const domNode of window.document.querySelectorAll(`${ tagName }[${ linkables[tagName] }*="?` + `${ _configurator2.default.hashAlgorithm }="]`)) domNode.setAttribute(linkables[tagName], domNode.getAttribute(linkables[tagName]).replace(new RegExp(`(\\?${ _configurator2.default.hashAlgorithm }=` + '[^&]+).*$'), '$1'));
                compilation.assets[_configurator2.default.files.html[0].filename] = new _webpackSources.RawSource(compilation.assets[_configurator2.default.files.html[0].filename].source().replace(/^(\s*<!doctype[^>]+?>\s*)[\s\S]*$/i, '$1') + window.document.documentElement.outerHTML);
                callback();
            });else callback();
        });
    } });
// /// endregion
// /// region add automatic image compression
// NOTE: This plugin should be loaded at last to ensure that all emitted images
// ran through.
pluginInstances.push(new plugins.Imagemin(_configurator2.default.module.optimizer.image.content));
// /// endregion
// // endregion
// / region loader
let imageLoader = 'url?' + JSON.stringify(_configurator2.default.module.optimizer.image.file);
const loader = {
    preprocessor: {
        cascadingStyleSheet: 'postcss',
        javaScript: 'babel?' + JSON.stringify(_configurator2.default.module.preprocessor.modernJavaScript),
        pug: `pug?${ JSON.stringify(_configurator2.default.module.preprocessor.pug) }`,
        // TODO deprecated
        coffee: 'coffee',
        literateCoffee: 'coffee?literate',
        less: `less?${ JSON.stringify(_configurator2.default.module.preprocessor.less) }`,
        sass: `sass?${ JSON.stringify(_configurator2.default.module.preprocessor.sass) }`,
        scss: `sass?${ JSON.stringify(_configurator2.default.module.preprocessor.scss) }`
        //
    },
    html: `html?${ JSON.stringify(_configurator2.default.module.html) }`,
    cascadingStyleSheet: 'css?' + JSON.stringify(_configurator2.default.module.cascadingStyleSheet),
    style: `style?${ JSON.stringify(_configurator2.default.module.style) }`,
    postprocessor: {
        image: imageLoader,
        font: {
            eot: 'url?' + JSON.stringify(_configurator2.default.module.optimizer.font.eot),
            woff: 'url?' + JSON.stringify(_configurator2.default.module.optimizer.font.woff),
            ttf: 'url?' + JSON.stringify(_configurator2.default.module.optimizer.font.ttf),
            svg: 'url?' + JSON.stringify(_configurator2.default.module.optimizer.font.svg)
        },
        data: `url?${ JSON.stringify(_configurator2.default.module.optimizer.data) }`
    }
};
// / endregion
// endregion
// region configuration
exports.default = {
    context: _configurator2.default.path.context,
    debug: _configurator2.default.debug,
    devtool: _configurator2.default.development.tool,
    devserver: _configurator2.default.development.server,
    // region input
    entry: normalizedInternalInjection, externals: injection.external,
    resolveLoader: _configurator2.default.loader,
    resolve: {
        alias: _configurator2.default.module.aliases,
        extensions: _configurator2.default.knownExtensions,
        root: [_configurator2.default.path.asset.source]
    },
    // endregion
    // region output
    output: {
        filename: _configurator2.default.files.javaScript,
        hashFunction: _configurator2.default.hashAlgorithm,
        library: libraryName,
        libraryTarget: _configurator2.default.givenCommandLineArguments[2] === 'buildDLL' ? 'var' : _configurator2.default.exportFormat,
        path: _configurator2.default.path.asset.target,
        // publicPath: configuration.path.asset.publicTarget,
        pathinfo: _configurator2.default.debug,
        umdNamedDefine: true
    },
    target: _configurator2.default.target,
    // endregion
    module: {
        noParse: _configurator2.default.module.skipParseRegularExpression,
        preLoaders: [
        // Convert to native web types.
        // region script
        {
            test: /\.js$/,
            loader: loader.preprocessor.javaScript,
            include: [_path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.javaScript)].concat(moduleLocations.directoryPaths),
            exclude: filePath => _helper2.default.isFilePathInLocation(filePath.replace(/^(.+)(?:\?[^?]*)$/, '$1'), _configurator2.default.path.ignore)
        }, {
            test: /\.coffee$/,
            loader: loader.preprocessor.coffee,
            include: [_path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.coffeeScript)].concat(moduleLocations.directoryPaths)
        }, {
            test: /\.(?:coffee\.md|litcoffee)$/,
            loader: loader.preprocessor.literateCoffee,
            include: [_path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.coffeeScript)].concat(moduleLocations.directoryPaths)
        },
        // endregion
        // region html (templates)
        {
            test: /\.pug$/,
            loader: `file?name=${ _configurator2.default.path.asset.template }` + `[name].html?${ _configurator2.default.hashAlgorithm }=[hash]!` + `extract!${ loader.html }!${ loader.preprocessor.pug }`,
            include: _path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.template),
            exclude: _configurator2.default.files.html.map(htmlConfiguration => htmlConfiguration.template.substring(htmlConfiguration.template.lastIndexOf('!') + 1))
        }
        // endregion
        ],
        loaders: [
        // Loads dependencies.
        // region style
        // TODO deprecated
        {
            test: /\.less$/,
            loader: plugins.ExtractText.extract(loader.style, `${ loader.cascadingStyleSheet }!${ loader.preprocessor.less }`)
        }, {
            test: /\.sass$/,
            loader: plugins.ExtractText.extract(loader.style, `${ loader.cascadingStyleSheet }!${ loader.preprocessor.sass }`)
        }, {
            test: /\.scss$/,
            loader: plugins.ExtractText.extract(loader.style, `${ loader.cascadingStyleSheet }!${ loader.preprocessor.scss }`)
        },
        //
        {
            test: /\.css$/,
            loader: plugins.ExtractText.extract(loader.style, `${ loader.preprocessor.cascadingStyleSheet }!` + loader.cascadingStyleSheet),
            include: [_path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.cascadingStyleSheet)].concat(moduleLocations.directoryPaths),
            exclude: filePath => _helper2.default.isFilePathInLocation(filePath.replace(/^(.+)(?:\?[^?]*)$/, '$1'), _configurator2.default.path.ignore)
        },
        // endregion
        // region html (templates)
        {
            test: /\.html$/,
            loader: `file?name=${ _configurator2.default.path.asset.template }` + `[name].[ext]?${ _configurator2.default.hashAlgorithm }=[hash]!` + `extract!${ loader.html }`,
            include: _path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.template),
            exclude: _configurator2.default.files.html.map(htmlConfiguration => htmlConfiguration.template.substring(htmlConfiguration.template.lastIndexOf('!') + 1))
        }
        // endregion
        ],
        postLoaders: [
        // Optimize loaded assets.
        // region font
        {
            test: /\.eot(?:\?v=\d+\.\d+\.\d+)?$/,
            loader: loader.postprocessor.font.eot
        }, { test: /\.woff2?$/, loader: loader.postprocessor.font.woff }, {
            test: /\.ttf(?:\?v=\d+\.\d+\.\d+)?$/,
            loader: loader.postprocessor.font.ttf
        }, {
            test: /\.svg(?:\?v=\d+\.\d+\.\d+)?$/,
            loader: loader.postprocessor.font.svg
        },
        // endregion
        // region image
        {
            test: /\.(?:png|jpg|ico|gif)$/,
            loader: loader.postprocessor.image
        },
        // endregion
        // region data
        {
            test: /.+/,
            loader: loader.postprocessor.data,
            include: _path2.default.join(_configurator2.default.path.asset.source, _configurator2.default.path.asset.data),
            exclude: filePath => _configurator2.default.knownExtensions.includes(_path2.default.extname(filePath.replace(/^(.+)(?:\?[^?]*)$/, '$1')))
        }
        // endregion
        ]
    },
    postcss: () => [_autoprefixer2.default, (0, _postcssImport2.default)({ addDependencyTo: _webpack2.default })],
    html: _configurator2.default.module.optimizer.htmlMinifier,
    // Let the "html-loader" access full html minifier processing
    // configuration.
    pug: _configurator2.default.module.preprocessor.pug,
    plugins: pluginInstances
};
// endregion
// region vim modline
// vim: set tabstop=4 shiftwidth=4 expandtab:
// vim: foldmethod=marker foldmarker=region,endregion:
// endregion

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2tDb25maWd1cmF0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTs7Ozs7O0FBQ0E7O0lBQVksVTs7QUFDWjs7SUFBWSxHOztBQUNaOzs7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOztBQUtBOzs7O0FBRUE7O0FBY0E7Ozs7QUFDQTs7OztBQUtBOzs7O0FBTUE7Ozs7Ozs7O0FBaENBO0FBQ0EsSUFBSTtBQUNBLFlBQVEsNkJBQVI7QUFDSCxDQUZELENBRUUsT0FBTyxLQUFQLEVBQWMsQ0FBRTs7QUFFbEIsTUFBTSxVQUFVLFFBQVEsc0JBQVIsR0FBaEI7OztBQUdBLFFBQVEsSUFBUixHQUFlLFFBQVEsSUFBdkI7QUFDQSxRQUFRLFdBQVIsR0FBc0IsUUFBUSxXQUE5QjtBQUNBLFFBQVEsa0JBQVIsR0FBNkIsUUFBUSwrQkFBUixDQUE3QjtBQUNBLFFBQVEsV0FBUixHQUFzQixRQUFRLFdBQTlCO0FBQ0EsUUFBUSxPQUFSLEdBQWtCLFFBQVEseUJBQVIsQ0FBbEI7QUFDQSxRQUFRLFFBQVIsR0FBbUIsUUFBUSx5QkFBUixFQUFtQyxPQUF0RDtBQUNBLFFBQVEsT0FBUixHQUFrQixRQUFRLGdCQUFSLENBQWxCOztBQVNBO0FBQ0E7QUFDQTs7O0FBRUEsUUFBUSxLQUFSLENBQWMsUUFBUSxPQUFSLENBQWdCLGFBQWhCLENBQWQsRUFBOEMsT0FBOUMsR0FBd0QsWUFBZTtBQUNuRSxxQkFBTyxZQUFQLENBQW9CLElBQXBCLEVBQTBCLEtBQUssT0FBL0IsRUFBd0MsTUFBeEMsRUFBZ0QsS0FBSyxPQUFyRDtBQUNBLFdBQU8scUJBQXVCLEtBQXZCLENBQTZCLElBQTdCLEVBQW1DLFNBQW5DLENBQVA7QUFDSCxDQUhEO0FBSUE7O0FBRUEsTUFBTSxnQ0FDRixzQkFBd0IsWUFENUI7QUFFQSxRQUFRLEtBQVIsQ0FBYyxRQUFRLE9BQVIsQ0FBZ0IsY0FBaEIsQ0FBZCxFQUErQyxPQUEvQyxDQUF1RCxZ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QUFFSSxvQkFBUSxPQUFPLGFBQVAsQ0FBcUIsSUFGakM7QUFHSSxxQkFBUyxlQUFLLElBQUwsQ0FDTCx1QkFBYyxJQUFkLENBQW1CLEtBQW5CLENBQXlCLE1BRHBCLEVBRUwsdUJBQWMsSUFBZCxDQUFtQixLQUFuQixDQUF5QixJQUZwQixDQUhiO0FBTUkscUJBQVUsUUFBRCxJQUNMLHVCQUFjLGVBQWQsQ0FBOEIsUUFBOUIsQ0FDSSxlQUFLLE9BQUwsQ0FBYSxTQUFTLE9BQVQsQ0FDVCxtQkFEUyxFQUNZLElBRFosQ0FBYixDQURKO0FBUFI7QUFXQTtBQWhDUztBQTFHVCxLQTdCRztBQTBLWCxhQUFTLE1BQW9CLHlCQUNYLDZCQUFjLEVBQUMsa0NBQUQsRUFBZCxDQURXLENBMUtsQjtBQTZLWCxVQUFNLHVCQUFjLE1BQWQsQ0FBcUIsU0FBckIsQ0FBK0IsWUE3SzFCO0FBOEtYO0FBQ0E7QUFDQSxTQUFLLHVCQUFjLE1BQWQsQ0FBcUIsWUFBckIsQ0FBa0MsR0FoTDVCO0FBaUxYLGFBQVM7QUFqTEUsQztBQW1MZjtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IndlYnBhY2tDb25maWd1cmF0b3IuY29tcGlsZWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXG4vLyBAZmxvd1xuLy8gLSotIGNvZGluZzogdXRmLTggLSotXG4ndXNlIHN0cmljdCdcbi8qICFcbiAgICByZWdpb24gaGVhZGVyXG4gICAgQ29weXJpZ2h0IFRvcmJlbiBTaWNrZXJ0IChpbmZvW1wifmF0flwiXXRvcmJlbi53ZWJzaXRlKSAxNi4xMi4yMDEyXG5cbiAgICBMaWNlbnNlXG4gICAgLS0tLS0tLVxuXG4gICAgVGhpcyBsaWJyYXJ5IHdyaXR0ZW4gYnkgVG9yYmVuIFNpY2tlcnQgc3RhbmQgdW5kZXIgYSBjcmVhdGl2ZSBjb21tb25zIG5hbWluZ1xuICAgIDMuMCB1bnBvcnRlZCBsaWNlbnNlLiBzZWUgaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvMy4wL2RlZWQuZGVcbiAgICBlbmRyZWdpb25cbiovXG4vLyByZWdpb24gaW1wb3J0c1xuaW1wb3J0ICogYXMgZmlsZVN5c3RlbSBmcm9tICdmcydcbmltcG9ydCAqIGFzIGRvbSBmcm9tICdqc2RvbSdcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5cbmltcG9ydCBhdXRvcHJlZml4ZXIgZnJvbSAnYXV0b3ByZWZpeGVyJ1xuaW1wb3J0IHBvc3Rjc3NJbXBvcnQgZnJvbSAncG9zdGNzcy1pbXBvcnQnXG5pbXBvcnQge3N5bmMgYXMgcmVtb3ZlRGlyZWN0b3J5UmVjdXJzaXZlbHlTeW5jfSBmcm9tICdyaW1yYWYnXG4vLyBOT1RFOiBPbmx5IG5lZWRlZCBmb3IgZGVidWdnaW5nIHRoaXMgZmlsZS5cbnRyeSB7XG4gICAgcmVxdWlyZSgnc291cmNlLW1hcC1zdXBwb3J0L3JlZ2lzdGVyJylcbn0gY2F0Y2ggKGVycm9yKSB7fVxuaW1wb3J0IHdlYnBhY2sgZnJvbSAnd2VicGFjaydcbmNvbnN0IHBsdWdpbnMgPSByZXF1aXJlKCd3ZWJwYWNrLWxvYWQtcGx1Z2lucycpKClcbmltcG9ydCB7UmF3U291cmNlIGFzIFdlYnBhY2tSYXdTb3VyY2V9IGZyb20gJ3dlYnBhY2stc291cmNlcydcblxucGx1Z2lucy5IVE1MID0gcGx1Z2lucy5odG1sXG5wbHVnaW5zLkV4dHJhY3RUZXh0ID0gcGx1Z2lucy5leHRyYWN0VGV4dFxucGx1Z2lucy5BZGRBc3NldEh0bWxQbHVnaW4gPSByZXF1aXJlKCdhZGQtYXNzZXQtaHRtbC13ZWJwYWNrLXBsdWdpbicpXG5wbHVnaW5zLk9wZW5Ccm93c2VyID0gcGx1Z2lucy5vcGVuQnJvd3NlclxucGx1Z2lucy5GYXZpY29uID0gcmVxdWlyZSgnZmF2aWNvbnMtd2VicGFjay1wbHVnaW4nKVxucGx1Z2lucy5JbWFnZW1pbiA9IHJlcXVpcmUoJ2ltYWdlbWluLXdlYnBhY2stcGx1Z2luJykuZGVmYXVsdFxucGx1Z2lucy5PZmZsaW5lID0gcmVxdWlyZSgnb2ZmbGluZS1wbHVnaW4nKVxuXG5pbXBvcnQgdHlwZSB7XG4gICAgRG9tTm9kZSwgSFRNTENvbmZpZ3VyYXRpb24sIEluamVjdGlvbiwgTm9ybWFsaXplZEludGVybmFsSW5qZWN0aW9uLFxuICAgIFByb2NlZHVyZUZ1bmN0aW9uXG59IGZyb20gJy4vdHlwZSdcbmltcG9ydCBjb25maWd1cmF0aW9uIGZyb20gJy4vY29uZmlndXJhdG9yLmNvbXBpbGVkJ1xuaW1wb3J0IEhlbHBlciBmcm9tICcuL2hlbHBlci5jb21waWxlZCdcblxuLy8gLyByZWdpb24gbW9ua2V5IHBhdGNoZXNcbi8vIE1vbmtleS1QYXRjaCBodG1sIGxvYWRlciB0byByZXRyaWV2ZSBodG1sIGxvYWRlciBvcHRpb25zIHNpbmNlIHRoZVxuLy8gXCJ3ZWJwYWNrLWh0bWwtcGx1Z2luXCIgZG9lc24ndCBwcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgbG9hZGVyIGludGVyZmFjZS5cbmltcG9ydCBodG1sTG9hZGVyTW9kdWxlQmFja3VwIGZyb20gJ2h0bWwtbG9hZGVyJ1xucmVxdWlyZS5jYWNoZVtyZXF1aXJlLnJlc29sdmUoJ2h0bWwtbG9hZGVyJyldLmV4cG9ydHMgPSBmdW5jdGlvbigpOmFueSB7XG4gICAgSGVscGVyLmV4dGVuZE9iamVjdCh0cnVlLCB0aGlzLm9wdGlvbnMsIG1vZHVsZSwgdGhpcy5vcHRpb25zKVxuICAgIHJldHVybiBodG1sTG9hZGVyTW9kdWxlQmFja3VwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbn1cbi8vIE1vbmtleS1QYXRjaCBsb2FkZXItdXRpbHMgdG8gZGVmaW5lIHdoaWNoIHVybCBpcyBhIGxvY2FsIHJlcXVlc3QuXG5pbXBvcnQgbG9hZGVyVXRpbHNNb2R1bGVCYWNrdXAgZnJvbSAnbG9hZGVyLXV0aWxzJ1xuY29uc3QgbG9hZGVyVXRpbHNJc1VybFJlcXVlc3RCYWNrdXA6KHVybDpzdHJpbmcpID0+IGJvb2xlYW4gPVxuICAgIGxvYWRlclV0aWxzTW9kdWxlQmFja3VwLmlzVXJsUmVxdWVzdFxucmVxdWlyZS5jYWNoZVtyZXF1aXJlLnJlc29sdmUoJ2xvYWRlci11dGlscycpXS5leHBvcnRzLmlzVXJsUmVxdWVzdCA9IGZ1bmN0aW9uKFxuICAgIHVybDpzdHJpbmdcbik6Ym9vbGVhbiB7XG4gICAgaWYgKHVybC5tYXRjaCgvXlthLXpdKzouKy8pKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICByZXR1cm4gbG9hZGVyVXRpbHNJc1VybFJlcXVlc3RCYWNrdXAuYXBwbHkoXG4gICAgICAgIGxvYWRlclV0aWxzTW9kdWxlQmFja3VwLCBhcmd1bWVudHMpXG59XG4vLyAvIGVuZHJlZ2lvblxuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gaW5pdGlhbGlzYXRpb25cbmxldCBsaWJyYXJ5TmFtZTpzdHJpbmcgPSBjb25maWd1cmF0aW9uLmV4cG9ydEZvcm1hdCA9PT0gJ3ZhcicgP1xuICAgIEhlbHBlci5jb252ZXJ0VG9WYWxpZFZhcmlhYmxlTmFtZShjb25maWd1cmF0aW9uLm5hbWUpIDogY29uZmlndXJhdGlvbi5uYW1lXG4vLyAvLyByZWdpb24gcGx1Z2luc1xuY29uc3QgcGx1Z2luSW5zdGFuY2VzOkFycmF5PE9iamVjdD4gPSBbXG4gICAgbmV3IHdlYnBhY2sub3B0aW1pemUuT2NjdXJyZW5jZU9yZGVyUGx1Z2luKHRydWUpXVxuLy8gLy8vIHJlZ2lvbiBnZW5lcmF0ZSBodG1sIGZpbGVcbmxldCBodG1sQXZhaWxhYmxlOmJvb2xlYW4gPSBmYWxzZVxuaWYgKGNvbmZpZ3VyYXRpb24uZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50c1syXSAhPT0gJ2J1aWxkRExMJylcbiAgICBmb3IgKGNvbnN0IGh0bWxDb25maWd1cmF0aW9uOkhUTUxDb25maWd1cmF0aW9uIG9mIGNvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbClcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGVTeXN0ZW0uYWNjZXNzU3luYyhodG1sQ29uZmlndXJhdGlvbi50ZW1wbGF0ZS5zdWJzdHJpbmcoXG4gICAgICAgICAgICAgICAgaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUubGFzdEluZGV4T2YoJyEnKSArIDFcbiAgICAgICAgICAgICksIGZpbGVTeXN0ZW0uRl9PSylcbiAgICAgICAgICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKG5ldyBwbHVnaW5zLkhUTUwoaHRtbENvbmZpZ3VyYXRpb24pKVxuICAgICAgICAgICAgaHRtbEF2YWlsYWJsZSA9IHRydWVcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHt9XG4vLyAvLy8gZW5kcmVnaW9uXG4vLyAvLy8gcmVnaW9uIGdlbmVyYXRlIGZhdmljb25zXG5pZiAoaHRtbEF2YWlsYWJsZSAmJiBjb25maWd1cmF0aW9uLmZhdmljb24pIHtcbiAgICBsZXQgZmF2aWNvbkF2YWlsYWJsZTpib29sZWFuID0gZmFsc2VcbiAgICB0cnkge1xuICAgICAgICBmaWxlU3lzdGVtLmFjY2Vzc1N5bmMoY29uZmlndXJhdGlvbi5mYXZpY29uLmxvZ28sIGZpbGVTeXN0ZW0uRl9PSylcbiAgICAgICAgZmF2aWNvbkF2YWlsYWJsZSA9IHRydWVcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChmYXZpY29uQXZhaWxhYmxlKVxuICAgICAgICAgICAgcGx1Z2luSW5zdGFuY2VzLnB1c2gobmV3IHBsdWdpbnMuRmF2aWNvbihjb25maWd1cmF0aW9uLmZhdmljb24pKVxuICAgIH1cbn1cbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gcHJvdmlkZSBvZmZsaW5lIGZ1bmN0aW9uYWxpdHlcbmlmIChodG1sQXZhaWxhYmxlICYmIGNvbmZpZ3VyYXRpb24ub2ZmbGluZSkge1xuICAgIGlmIChjb25maWd1cmF0aW9uLmluUGxhY2UuY2FzY2FkaW5nU3R5bGVTaGVldClcbiAgICAgICAgY29uZmlndXJhdGlvbi5vZmZsaW5lLmV4Y2x1ZGVzLnB1c2goXG4gICAgICAgICAgICBgJHtjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuY2FzY2FkaW5nU3R5bGVTaGVldH0qLmNzcz9gICtcbiAgICAgICAgICAgIGAke2NvbmZpZ3VyYXRpb24uaGFzaEFsZ29yaXRobX09KmApXG4gICAgaWYgKGNvbmZpZ3VyYXRpb24uaW5QbGFjZS5qYXZhU2NyaXB0KVxuICAgICAgICBjb25maWd1cmF0aW9uLm9mZmxpbmUuZXhjbHVkZXMucHVzaChcbiAgICAgICAgICAgIGAke2NvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC5qYXZhU2NyaXB0fSouanM/YCArXG4gICAgICAgICAgICBgJHtjb25maWd1cmF0aW9uLmhhc2hBbGdvcml0aG19PSpgKVxuICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKG5ldyBwbHVnaW5zLk9mZmxpbmUoY29uZmlndXJhdGlvbi5vZmZsaW5lKSlcbn1cbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gb3BlbnMgYnJvd3NlciBhdXRvbWF0aWNhbGx5XG5pZiAoY29uZmlndXJhdGlvbi5kZXZlbG9wbWVudC5vcGVuQnJvd3NlciAmJiAoaHRtbEF2YWlsYWJsZSAmJiBbXG4gICAgJ3NlcnZlJywgJ3Rlc3RJbkJyb3dzZXInXG5dLmluY2x1ZGVzKGNvbmZpZ3VyYXRpb24uZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50c1syXSkpKVxuICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKG5ldyBwbHVnaW5zLk9wZW5Ccm93c2VyKFxuICAgICAgICBjb25maWd1cmF0aW9uLmRldmVsb3BtZW50Lm9wZW5Ccm93c2VyKSlcbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gcHJvdmlkZSBidWlsZCBlbnZpcm9ubWVudFxucGx1Z2luSW5zdGFuY2VzLnB1c2gobmV3IHdlYnBhY2suRGVmaW5lUGx1Z2luKGNvbmZpZ3VyYXRpb24uYnVpbGREZWZpbml0aW9uKSlcbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gbW9kdWxlcy9hc3NldHNcbmNvbnN0IG1vZHVsZUxvY2F0aW9uczp7W2tleTpzdHJpbmddOkFycmF5PHN0cmluZz59ID1cbiAgICBIZWxwZXIuZGV0ZXJtaW5lTW9kdWxlTG9jYXRpb25zKFxuICAgICAgICBjb25maWd1cmF0aW9uLmluamVjdGlvbi5pbnRlcm5hbCwgY29uZmlndXJhdGlvbi5tb2R1bGUuYWxpYXNlcyxcbiAgICAgICAgY29uZmlndXJhdGlvbi5rbm93bkV4dGVuc2lvbnMsIGNvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LFxuICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguaWdub3JlKVxuLy8gLy8vLyByZWdpb24gZXh0cmFjdCBjYXNjYWRpbmcgc3R5bGUgc2hlZXRzXG5wbHVnaW5JbnN0YW5jZXMucHVzaChuZXcgcGx1Z2lucy5FeHRyYWN0VGV4dChcbiAgICBjb25maWd1cmF0aW9uLmZpbGVzLmNhc2NhZGluZ1N0eWxlU2hlZXQsIHtcbiAgICAgICAgYWxsQ2h1bmtzOiB0cnVlLCBkaXNhYmxlOiAhY29uZmlndXJhdGlvbi5maWxlcy5jYXNjYWRpbmdTdHlsZVNoZWV0fSkpXG4vLyAvLy8vIGVuZHJlZ2lvblxuLy8gLy8vLyByZWdpb24gcGVyZm9ybSBqYXZhU2NyaXB0IG1pbmlmaWNhdGlvbi9vcHRpbWlzYXRpb25cbmlmIChjb25maWd1cmF0aW9uLm1vZHVsZS5vcHRpbWl6ZXIudWdsaWZ5SlMpXG4gICAgcGx1Z2luSW5zdGFuY2VzLnB1c2gobmV3IHdlYnBhY2sub3B0aW1pemUuVWdsaWZ5SnNQbHVnaW4oXG4gICAgICAgIGNvbmZpZ3VyYXRpb24ubW9kdWxlLm9wdGltaXplci51Z2xpZnlKUykpXG4vLyAvLy8vIGVuZHJlZ2lvblxuLy8gLy8vLyByZWdpb24gYXBwbHkgbW9kdWxlIHBhdHRlcm5cbnBsdWdpbkluc3RhbmNlcy5wdXNoKHthcHBseTogKGNvbXBpbGVyOk9iamVjdCk6dm9pZCA9PiB7XG4gICAgY29tcGlsZXIucGx1Z2luKCdlbWl0JywgKFxuICAgICAgICBjb21waWxhdGlvbjpPYmplY3QsIGNhbGxiYWNrOlByb2NlZHVyZUZ1bmN0aW9uXG4gICAgKTp2b2lkID0+IHtcbiAgICAgICAgZm9yIChjb25zdCByZXF1ZXN0OnN0cmluZyBpbiBjb21waWxhdGlvbi5hc3NldHMpXG4gICAgICAgICAgICBpZiAoY29tcGlsYXRpb24uYXNzZXRzLmhhc093blByb3BlcnR5KHJlcXVlc3QpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZVBhdGg6c3RyaW5nID0gcmVxdWVzdC5yZXBsYWNlKC9cXD9bXj9dKyQvLCAnJylcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlOj9zdHJpbmcgPSBIZWxwZXIuZGV0ZXJtaW5lQXNzZXRUeXBlKFxuICAgICAgICAgICAgICAgICAgICBmaWxlUGF0aCwgY29uZmlndXJhdGlvbi5idWlsZCwgY29uZmlndXJhdGlvbi5wYXRoKVxuICAgICAgICAgICAgICAgIGlmICh0eXBlICYmIGNvbmZpZ3VyYXRpb24uYXNzZXRQYXR0ZXJuW3R5cGVdICYmICEobmV3IFJlZ0V4cChcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5hc3NldFBhdHRlcm5bdHlwZV1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5leGNsdWRlRmlsZVBhdGhSZWd1bGFyRXhwcmVzc2lvblxuICAgICAgICAgICAgICAgICkpLnRlc3QoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZTo/c3RyaW5nID0gY29tcGlsYXRpb24uYXNzZXRzW3JlcXVlc3RdLnNvdXJjZSgpXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc291cmNlID09PSAnc3RyaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBpbGF0aW9uLmFzc2V0c1tyZXF1ZXN0XSA9IG5ldyBXZWJwYWNrUmF3U291cmNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24uYXNzZXRQYXR0ZXJuW3R5cGVdLnBhdHRlcm4ucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xcezFcXH0vZywgc291cmNlLnJlcGxhY2UoL1xcJC9nLCAnJCQkJykpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soKVxuICAgIH0pXG59fSlcbi8vIC8vLy8gZW5kcmVnaW9uXG4vLyAvLy8vIHJlZ2lvbiBpbi1wbGFjZSBjb25maWd1cmVkIGFzc2V0cyBpbiB0aGUgbWFpbiBodG1sIGZpbGVcbmlmIChodG1sQXZhaWxhYmxlICYmICFbJ3NlcnZlJywgJ3Rlc3RJbkJyb3dzZXInXS5pbmNsdWRlcyhcbiAgICBjb25maWd1cmF0aW9uLmdpdmVuQ29tbWFuZExpbmVBcmd1bWVudHNbMl1cbikpXG4gICAgcGx1Z2luSW5zdGFuY2VzLnB1c2goe2FwcGx5OiAoY29tcGlsZXI6T2JqZWN0KTp2b2lkID0+IHtcbiAgICAgICAgY29tcGlsZXIucGx1Z2luKCdlbWl0JywgKFxuICAgICAgICAgICAgY29tcGlsYXRpb246T2JqZWN0LCBjYWxsYmFjazpQcm9jZWR1cmVGdW5jdGlvblxuICAgICAgICApOnZvaWQgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbFswXS5maWxlbmFtZSBpbiBjb21waWxhdGlvbi5hc3NldHMgJiYgKFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24uaW5QbGFjZS5jYXNjYWRpbmdTdHlsZVNoZWV0IHx8XG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5pblBsYWNlLmphdmFTY3JpcHRcbiAgICAgICAgICAgICkpXG4gICAgICAgICAgICAgICAgZG9tLmVudihjb21waWxhdGlvbi5hc3NldHNbY29uZmlndXJhdGlvbi5maWxlcy5odG1sW1xuICAgICAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICAgICAgXS5maWxlbmFtZV0uc291cmNlKCksIChlcnJvcjo/RXJyb3IsIHdpbmRvdzpPYmplY3QpOnZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJhdGlvbi5pblBsYWNlLmNhc2NhZGluZ1N0eWxlU2hlZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybFByZWZpeDpzdHJpbmcgPSBjb25maWd1cmF0aW9uLmZpbGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhc2NhZGluZ1N0eWxlU2hlZXQucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1tjb250ZW50aGFzaF0nLCAnJylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbU5vZGU6RG9tTm9kZSA9IHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBsaW5rW2hyZWZePVwiJHt1cmxQcmVmaXh9XCJdYClcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFzc2V0OnN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYXNzZXQgaW4gY29tcGlsYXRpb24uYXNzZXRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXQuc3RhcnRzV2l0aCh1cmxQcmVmaXgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpblBsYWNlRG9tTm9kZTpEb21Ob2RlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpblBsYWNlRG9tTm9kZS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBpbGF0aW9uLmFzc2V0c1thc3NldF0uc291cmNlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpblBsYWNlRG9tTm9kZSwgZG9tTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZG9tTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1RFOiBUaGlzIGRvZXNuJ3QgcHJldmVudCB3ZWJwYWNrIGZyb21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRpbmcgdGhpcyBmaWxlIGlmIHByZXNlbnQgaW4gYW5vdGhlciBjaHVua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbyByZW1vdmluZyBpdCAoYW5kIGEgcG90ZW50aWFsIHNvdXJjZSBtYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSkgbGF0ZXIgaW4gdGhlIFwiZG9uZVwiIGhvb2suXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tcGlsYXRpb24uYXNzZXRzW2Fzc2V0XVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTm8gcmVmZXJlbmNlZCBjYXNjYWRpbmcgc3R5bGUgc2hlZXQgZmlsZSBpbicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHJlc3VsdGluZyBtYXJrdXAgZm91bmQgd2l0aCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYHNlbGVjdG9yOiBsaW5rW2hyZWZePVwiJHt1cmxQcmVmaXh9XCJdYClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJhdGlvbi5pblBsYWNlLmphdmFTY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybFByZWZpeDpzdHJpbmcgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24uZmlsZXMuamF2YVNjcmlwdC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnW2hhc2hdJywgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb21Ob2RlOkRvbU5vZGUgPSB3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgc2NyaXB0W3NyY149XCIke3VybFByZWZpeH1cIl1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXNzZXQ6c3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhc3NldCBpbiBjb21waWxhdGlvbi5hc3NldHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NldC5zdGFydHNXaXRoKHVybFByZWZpeCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUudGV4dENvbnRlbnQgPSBjb21waWxhdGlvbi5hc3NldHNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5zb3VyY2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUucmVtb3ZlQXR0cmlidXRlKCdzcmMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVEU6IFRoaXMgZG9lc24ndCBwcmV2ZW50IHdlYnBhY2sgZnJvbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGluZyB0aGlzIGZpbGUgaWYgcHJlc2VudCBpbiBhbm90aGVyIGNodW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvIHJlbW92aW5nIGl0IChhbmQgYSBwb3RlbnRpYWwgc291cmNlIG1hcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlKSBsYXRlciBpbiB0aGUgXCJkb25lXCIgaG9vay5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb21waWxhdGlvbi5hc3NldHNbYXNzZXRdXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdObyByZWZlcmVuY2VkIGphdmFTY3JpcHQgZmlsZSBpbiByZXN1bHRpbmcgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXJrdXAgZm91bmQgd2l0aCBzZWxlY3RvcjogJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBzY3JpcHRbc3JjXj1cIiR7dXJsUHJlZml4fVwiXWApXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29tcGlsYXRpb24uYXNzZXRzW2NvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbFtcbiAgICAgICAgICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICAgICAgICAgXS5maWxlbmFtZV0gPSBuZXcgV2VicGFja1Jhd1NvdXJjZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBpbGF0aW9uLmFzc2V0c1tjb25maWd1cmF0aW9uLmZpbGVzLmh0bWxbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICAgICAgXS5maWxlbmFtZV0uc291cmNlKCkucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXihcXHMqPCFkb2N0eXBlW14+XSs/PlxccyopW1xcc1xcU10qJC9pLCAnJDEnXG4gICAgICAgICAgICAgICAgICAgICAgICApICsgd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUwpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgfSlcbiAgICAgICAgY29tcGlsZXIucGx1Z2luKCdhZnRlci1lbWl0JywgKFxuICAgICAgICAgICAgY29tcGlsYXRpb246T2JqZWN0LCBjYWxsYmFjazpQcm9jZWR1cmVGdW5jdGlvblxuICAgICAgICApOnZvaWQgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbFswXS5maWxlbmFtZSBpbiBjb21waWxhdGlvbi5hc3NldHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJhdGlvbi5pblBsYWNlLmNhc2NhZGluZ1N0eWxlU2hlZXQpXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZURpcmVjdG9yeVJlY3Vyc2l2ZWx5U3luYyhwYXRoLmpvaW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQudGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LmNhc2NhZGluZ1N0eWxlU2hlZXRcbiAgICAgICAgICAgICAgICAgICAgKSwge2dsb2I6IGZhbHNlfSlcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJhdGlvbi5pblBsYWNlLmphdmFTY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxlUGF0aCA9IHBhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC50YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLmZpbGVzLmphdmFTY3JpcHQucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPyR7Y29uZmlndXJhdGlvbi5oYXNoQWxnb3JpdGhtfT1baGFzaF1gLCAnJykpXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZVBhdGg6c3RyaW5nIG9mIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0RmlsZVBhdGgsIGAke2Fzc2V0RmlsZVBhdGh9Lm1hcGBcbiAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVN5c3RlbS51bmxpbmtTeW5jKGZpbGVQYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHt9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGphdmFTY3JpcHRQYXRoOnN0cmluZyA9IHBhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC50YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuamF2YVNjcmlwdClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVTeXN0ZW0ucmVhZGRpclN5bmMoamF2YVNjcmlwdFBhdGgpLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVTeXN0ZW0ucm1kaXJTeW5jKGphdmFTY3JpcHRQYXRoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgfSlcbiAgICB9fSlcbi8vIC8vLy8gZW5kcmVnaW9uXG5jb25zdCBpbmplY3Rpb246SW5qZWN0aW9uID0gSGVscGVyLnJlc29sdmVJbmplY3Rpb24oXG4gICAgY29uZmlndXJhdGlvbi5pbmplY3Rpb24sIEhlbHBlci5yZXNvbHZlQnVpbGRDb25maWd1cmF0aW9uRmlsZVBhdGhzKFxuICAgICAgICBjb25maWd1cmF0aW9uLmJ1aWxkLCBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuc291cmNlLFxuICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguY29udGV4dCwgY29uZmlndXJhdGlvbi5wYXRoLmlnbm9yZVxuICAgICksIGNvbmZpZ3VyYXRpb24udGVzdEluQnJvd3Nlci5pbmplY3Rpb24uaW50ZXJuYWwsXG4gICAgY29uZmlndXJhdGlvbi5tb2R1bGUuYWxpYXNlcywgY29uZmlndXJhdGlvbi5rbm93bkV4dGVuc2lvbnMsXG4gICAgY29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQsIGNvbmZpZ3VyYXRpb24ucGF0aC5pZ25vcmUpXG5sZXQgamF2YVNjcmlwdE5lZWRlZDpib29sZWFuID0gZmFsc2VcbmNvbnN0IG5vcm1hbGl6ZWRJbnRlcm5hbEluamVjdGlvbjpOb3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24gPVxuICAgIEhlbHBlci5ub3JtYWxpemVJbnRlcm5hbEluamVjdGlvbihpbmplY3Rpb24uaW50ZXJuYWwpXG4vLyAvLy8vIHJlZ2lvbiByZW1vdmUgY2h1bmtzIGlmIGEgY29ycmVzcG9uZGluZyBkbGwgcGFja2FnZSBleGlzdHNcbmlmIChjb25maWd1cmF0aW9uLmdpdmVuQ29tbWFuZExpbmVBcmd1bWVudHNbMl0gIT09ICdidWlsZERMTCcpXG4gICAgZm9yIChjb25zdCBjaHVua0lEOnN0cmluZyBpbiBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24pXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRJbnRlcm5hbEluamVjdGlvbi5oYXNPd25Qcm9wZXJ0eShjaHVua0lEKSAmJlxuICAgICAgICAgICAgY29uZmlndXJhdGlvbi5kbGxNYW5pZmVzdEZpbGVQYXRocy5pbmNsdWRlcyhcbiAgICAgICAgICAgICAgICBgJHtjb25maWd1cmF0aW9uLnBhdGgudGFyZ2V0fSR7Y2h1bmtJRH0uZGxsLW1hbmlmZXN0Lmpzb25gKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGRlbGV0ZSBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb25bY2h1bmtJRF1cbiAgICAgICAgICAgIGxldCBzb3VyY2VNYXBFeGlzdHM6Ym9vbGVhbiA9IGZhbHNlXG4gICAgICAgICAgICAvLyBUT0RPIHJlcGxhY2UgYWxsIHBsYWNlaG9sZGVyIGxpa2UgXCJbaWRdXCIsIFwiW2V4dF1cIiwgXCJbaGFzaF1cIiBhbmRcbiAgICAgICAgICAgIC8vIGV2ZXJ5d2hlcmUgZWxzZVxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWU6c3RyaW5nID0gY29uZmlndXJhdGlvbi5maWxlcy5qYXZhU2NyaXB0LnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgL14oLispKD86XFw/W14/XSopJC8sICckMSdcbiAgICAgICAgICAgICkucmVwbGFjZSgvXFxbbmFtZVxcXS9nLCBjaHVua0lEKVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmaWxlU3lzdGVtLmFjY2Vzc1N5bmMoXG4gICAgICAgICAgICAgICAgICAgIGAke2NvbmZpZ3VyYXRpb24ucGF0aC50YXJnZXR9JHtmaWxlTmFtZX0ubWFwYCxcbiAgICAgICAgICAgICAgICAgICAgZmlsZVN5c3RlbS5GX09LKVxuICAgICAgICAgICAgICAgIHNvdXJjZU1hcEV4aXN0cyA9IHRydWVcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fVxuICAgICAgICAgICAgcGx1Z2luSW5zdGFuY2VzLnB1c2gobmV3IHBsdWdpbnMuQWRkQXNzZXRIdG1sUGx1Z2luKHtcbiAgICAgICAgICAgICAgICBmaWxlbmFtZTogYCR7Y29uZmlndXJhdGlvbi5wYXRoLnRhcmdldH0ke2ZpbGVOYW1lfWAsXG4gICAgICAgICAgICAgICAgaW5jbHVkZVNvdXJjZW1hcDogc291cmNlTWFwRXhpc3RzXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKG5ldyB3ZWJwYWNrLkRsbFJlZmVyZW5jZVBsdWdpbih7XG4gICAgICAgICAgICAgICAgY29udGV4dDogY29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQsIG1hbmlmZXN0OiByZXF1aXJlKFxuICAgICAgICAgICAgICAgICAgICBgJHtjb25maWd1cmF0aW9uLnBhdGgudGFyZ2V0fSR7Y2h1bmtJRH0uZGxsLW1hbmlmZXN0Lmpzb25gKVxuICAgICAgICAgICAgfSkpXG4gICAgICAgIH1cbi8vIC8vLy8gZW5kcmVnaW9uXG4vLyAvLy8vIHJlZ2lvbiBnZW5lcmF0ZSBjb21tb24gY2h1bmtzXG5pZiAoY29uZmlndXJhdGlvbi5naXZlbkNvbW1hbmRMaW5lQXJndW1lbnRzWzJdICE9PSAnYnVpbGRETEwnKVxuICAgIGZvciAoY29uc3QgY2h1bmtJRDpzdHJpbmcgb2YgY29uZmlndXJhdGlvbi5pbmplY3Rpb24uY29tbW9uQ2h1bmtJRHMpXG4gICAgICAgIGlmIChub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24uaGFzT3duUHJvcGVydHkoY2h1bmtJRCkpXG4gICAgICAgICAgICBwbHVnaW5JbnN0YW5jZXMucHVzaChuZXcgd2VicGFjay5vcHRpbWl6ZS5Db21tb25zQ2h1bmtQbHVnaW4oe1xuICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGNvbmZpZ3VyYXRpb24uZmlsZXMuamF2YVNjcmlwdCxcbiAgICAgICAgICAgICAgICBtaW5DaHVua3M6IEluZmluaXR5LFxuICAgICAgICAgICAgICAgIG5hbWU6IGNodW5rSUQsXG4gICAgICAgICAgICAgICAgbWluU2l6ZTogMFxuICAgICAgICAgICAgfSkpXG4vLyAvLy8vIGVuZHJlZ2lvblxuLy8gLy8vLyByZWdpb24gbWFyayBlbXB0eSBqYXZhU2NyaXB0IG1vZHVsZXMgYXMgZHVtbXlcbmZvciAoY29uc3QgY2h1bmtOYW1lOnN0cmluZyBpbiBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24pXG4gICAgaWYgKG5vcm1hbGl6ZWRJbnRlcm5hbEluamVjdGlvbi5oYXNPd25Qcm9wZXJ0eShjaHVua05hbWUpKVxuICAgICAgICBmb3IgKGNvbnN0IG1vZHVsZUlEOnN0cmluZyBvZiBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb25bXG4gICAgICAgICAgICBjaHVua05hbWVcbiAgICAgICAgXSkge1xuICAgICAgICAgICAgY29uc3QgdHlwZTo/c3RyaW5nID0gSGVscGVyLmRldGVybWluZUFzc2V0VHlwZShcbiAgICAgICAgICAgICAgICBIZWxwZXIuZGV0ZXJtaW5lTW9kdWxlRmlsZVBhdGgoXG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUlELCBjb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLmtub3duRXh0ZW5zaW9ucywgY29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHRcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24uYnVpbGQsIGNvbmZpZ3VyYXRpb24ucGF0aClcbiAgICAgICAgICAgIGlmICh0eXBlICYmIGNvbmZpZ3VyYXRpb24uYnVpbGRbdHlwZV0gJiYgY29uZmlndXJhdGlvbi5idWlsZFtcbiAgICAgICAgICAgICAgICB0eXBlXG4gICAgICAgICAgICBdLm91dHB1dEV4dGVuc2lvbiA9PT0gJ2pzJykge1xuICAgICAgICAgICAgICAgIGphdmFTY3JpcHROZWVkZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuaWYgKCFqYXZhU2NyaXB0TmVlZGVkKVxuICAgIGNvbmZpZ3VyYXRpb24uZmlsZXMuamF2YVNjcmlwdCA9IHBhdGguam9pbihcbiAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LmphdmFTY3JpcHQsICcuX19kdW1teV9fLmNvbXBpbGVkLmpzJylcbi8vIC8vLy8gZW5kcmVnaW9uXG4vLyAvLy8vIHJlZ2lvbiBwZXJmb3JtcyBpbXBsaWNpdCBleHRlcm5hbCBsb2dpY1xuaWYgKGluamVjdGlvbi5leHRlcm5hbCA9PT0gJ19faW1wbGljaXRfXycpXG4gICAgLypcbiAgICAgICAgV2Ugb25seSB3YW50IHRvIHByb2Nlc3MgbW9kdWxlcyBmcm9tIGxvY2FsIGNvbnRleHQgaW4gbGlicmFyeSBtb2RlLFxuICAgICAgICBzaW5jZSBhIGNvbmNyZXRlIHByb2plY3QgdXNpbmcgdGhpcyBsaWJyYXJ5IHNob3VsZCBjb21iaW5lIGFsbCBhc3NldHNcbiAgICAgICAgKGFuZCBkZWR1cGxpY2F0ZSB0aGVtKSBmb3Igb3B0aW1hbCBidW5kbGluZyByZXN1bHRzLiBOT1RFOiBPbmx5IG5hdGl2ZVxuICAgICAgICBqYXZhU2NyaXB0IGFuZCBqc29uIG1vZHVsZXMgd2lsbCBiZSBtYXJrZWQgYXMgZXh0ZXJuYWwgZGVwZW5kZW5jeS5cbiAgICAqL1xuICAgIGluamVjdGlvbi5leHRlcm5hbCA9IChcbiAgICAgICAgY29udGV4dDpzdHJpbmcsIHJlcXVlc3Q6c3RyaW5nLCBjYWxsYmFjazpQcm9jZWR1cmVGdW5jdGlvblxuICAgICk6dm9pZCA9PiB7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoOnN0cmluZyA9IEhlbHBlci5kZXRlcm1pbmVNb2R1bGVGaWxlUGF0aChcbiAgICAgICAgICAgIHJlcXVlc3Quc3Vic3RyaW5nKHJlcXVlc3QubGFzdEluZGV4T2YoJyEnKSArIDEpLFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbi5tb2R1bGUuYWxpYXNlcywgY29uZmlndXJhdGlvbi5rbm93bkV4dGVuc2lvbnMsXG4gICAgICAgICAgICBjb250ZXh0KVxuICAgICAgICBpZiAoZmlsZVBhdGguZW5kc1dpdGgoJy5qcycpIHx8IGZpbGVQYXRoLmVuZHNXaXRoKCcuanNvbicpKSB7XG4gICAgICAgICAgICAvLyBOT1RFOiBXZSBhcHBseSBhbGlhcyBvbiBleHRlcm5hbHMgYWRkaXRpb25hbGx5LlxuICAgICAgICAgICAgSGVscGVyLmFwcGx5QWxpYXNlcyhcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnN1YnN0cmluZyhyZXF1ZXN0Lmxhc3RJbmRleE9mKCchJykgKyAxKSxcbiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzKVxuICAgICAgICAgICAgaWYgKHJlcXVlc3QubWF0Y2goXG4gICAgICAgICAgICAgICAgL153ZWJPcHRpbWl6ZXJcXC9icm93c2VyQVBJKD86XFwuY29tcGlsZWQpPyg/OlxcLmpzKT8vXG4gICAgICAgICAgICApKVxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIE5PVEU6IFRoZSBicm93c2VyIGFwaSBuZWVkcyBwcm9jZXNzaW5nIHNpbmNlIHRoZXJlIGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICBuZWVkZWQgY29tcGlsZSBmbGFncyB0byBhdm9pZCBsb2FkaW5nIGEgY29tcGxldGUgbm9kZVxuICAgICAgICAgICAgICAgICAgICBicm93c2VyIGFwaSBpbnRvIGEgcmVhbCBicm93c2VyLlxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKClcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2h1bmtOYW1lOnN0cmluZyBpbiBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24pXG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWRJbnRlcm5hbEluamVjdGlvbi5oYXNPd25Qcm9wZXJ0eShjaHVua05hbWUpKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kdWxlSUQ6c3RyaW5nIG9mXG4gICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb25bY2h1bmtOYW1lXVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoSGVscGVyLmRldGVybWluZU1vZHVsZUZpbGVQYXRoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUlELCBjb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ua25vd25FeHRlbnNpb25zLCBjb250ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICApID09PSBmaWxlUGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKVxuICAgICAgICAgICAgaWYgKCFwYXRoLnJlc29sdmUoZmlsZVBhdGgpLnN0YXJ0c1dpdGgoXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHRcbiAgICAgICAgICAgICkgfHwgSGVscGVyLmlzRmlsZVBhdGhJbkxvY2F0aW9uKFxuICAgICAgICAgICAgICAgIGZpbGVQYXRoLCBjb25maWd1cmF0aW9uLnBhdGguaWdub3JlXG4gICAgICAgICAgICApICYmICFjb25maWd1cmF0aW9uLmluUGxhY2UuZXh0ZXJuYWxMaWJyYXJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24uZXhwb3J0Rm9ybWF0ID09PSAndmFyJylcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdCA9IEhlbHBlci5jb252ZXJ0VG9WYWxpZFZhcmlhYmxlTmFtZShyZXF1ZXN0KVxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhcbiAgICAgICAgICAgICAgICAgICAgbnVsbCwgYCR7Y29uZmlndXJhdGlvbi5leHBvcnRGb3JtYXR9ICR7cmVxdWVzdH1gKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsYmFjaygpXG4gICAgfVxuLy8gLy8vLyBlbmRyZWdpb25cbi8vIC8vLy8gcmVnaW9uIGJ1aWxkIGRsbCBwYWNrYWdlc1xuaWYgKGNvbmZpZ3VyYXRpb24uZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50c1syXSA9PT0gJ2J1aWxkRExMJykge1xuICAgIGxldCBkbGxDaHVua0lERXhpc3RzOmJvb2xlYW4gPSBmYWxzZVxuICAgIGZvciAoY29uc3QgY2h1bmtJRDpzdHJpbmcgaW4gbm9ybWFsaXplZEludGVybmFsSW5qZWN0aW9uKVxuICAgICAgICBpZiAobm9ybWFsaXplZEludGVybmFsSW5qZWN0aW9uLmhhc093blByb3BlcnR5KGNodW5rSUQpKVxuICAgICAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmRsbENodW5rSURzLmluY2x1ZGVzKGNodW5rSUQpKVxuICAgICAgICAgICAgICAgIGRsbENodW5rSURFeGlzdHMgPSB0cnVlXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG5vcm1hbGl6ZWRJbnRlcm5hbEluamVjdGlvbltjaHVua0lEXVxuICAgIGlmIChkbGxDaHVua0lERXhpc3RzKSB7XG4gICAgICAgIGxpYnJhcnlOYW1lID0gJ1tuYW1lXURMTFBhY2thZ2UnXG4gICAgICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKG5ldyB3ZWJwYWNrLkRsbFBsdWdpbih7XG4gICAgICAgICAgICBwYXRoOiBgJHtjb25maWd1cmF0aW9uLnBhdGgudGFyZ2V0fVtuYW1lXS5kbGwtbWFuaWZlc3QuanNvbmAsXG4gICAgICAgICAgICBuYW1lOiBsaWJyYXJ5TmFtZVxuICAgICAgICB9KSlcbiAgICB9IGVsc2VcbiAgICAgICAgdGhyb3cgRXJyb3IoJ05vIGRsbCBjaHVuayBpZCBmb3VuZC4nKVxufVxuLy8gLy8vLyBlbmRyZWdpb25cbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gYXBwbHkgZmluYWwgZG9tIG1vZGlmaWNhdGlvbnMvZml4ZXNcbmlmIChodG1sQXZhaWxhYmxlKVxuICAgIHBsdWdpbkluc3RhbmNlcy5wdXNoKHthcHBseTogKGNvbXBpbGVyOk9iamVjdCk6dm9pZCA9PiB7XG4gICAgICAgIGNvbXBpbGVyLnBsdWdpbignZW1pdCcsIChcbiAgICAgICAgICAgIGNvbXBpbGF0aW9uOk9iamVjdCwgY2FsbGJhY2s6UHJvY2VkdXJlRnVuY3Rpb25cbiAgICAgICAgKTp2b2lkID0+IHtcbiAgICAgICAgICAgIGlmIChjb25maWd1cmF0aW9uLmZpbGVzLmh0bWxbMF0uZmlsZW5hbWUgaW4gY29tcGlsYXRpb24uYXNzZXRzKVxuICAgICAgICAgICAgICAgIGRvbS5lbnYoY29tcGlsYXRpb24uYXNzZXRzW2NvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbFtcbiAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgIF0uZmlsZW5hbWVdLnNvdXJjZSgpLCAoZXJyb3I6P0Vycm9yLCB3aW5kb3c6T2JqZWN0KTp2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua2FibGVzOntba2V5OnN0cmluZ106c3RyaW5nfSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdDogJ3NyYycsIGxpbms6ICdocmVmJ31cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0YWdOYW1lOnN0cmluZyBpbiBsaW5rYWJsZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlua2FibGVzLmhhc093blByb3BlcnR5KHRhZ05hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbU5vZGU6RG9tTm9kZSBvZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke3RhZ05hbWV9WyR7bGlua2FibGVzW3RhZ05hbWVdfSo9XCI/YCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHtjb25maWd1cmF0aW9uLmhhc2hBbGdvcml0aG19PVwiXWApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnNldEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmthYmxlc1t0YWdOYW1lXSwgZG9tTm9kZS5nZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2FibGVzW3RhZ05hbWVdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLnJlcGxhY2UobmV3IFJlZ0V4cChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgKFxcXFw/JHtjb25maWd1cmF0aW9uLmhhc2hBbGdvcml0aG19PWAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdbXiZdKykuKiQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLCAnJDEnKSlcbiAgICAgICAgICAgICAgICAgICAgY29tcGlsYXRpb24uYXNzZXRzW2NvbmZpZ3VyYXRpb24uZmlsZXMuaHRtbFtcbiAgICAgICAgICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICAgICAgICAgXS5maWxlbmFtZV0gPSBuZXcgV2VicGFja1Jhd1NvdXJjZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBpbGF0aW9uLmFzc2V0c1tjb25maWd1cmF0aW9uLmZpbGVzLmh0bWxbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICAgICAgXS5maWxlbmFtZV0uc291cmNlKCkucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXihcXHMqPCFkb2N0eXBlW14+XSs/PlxccyopW1xcc1xcU10qJC9pLCAnJDEnXG4gICAgICAgICAgICAgICAgICAgICAgICApICsgd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUwpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgfSlcbiAgICB9fSlcbi8vIC8vLyBlbmRyZWdpb25cbi8vIC8vLyByZWdpb24gYWRkIGF1dG9tYXRpYyBpbWFnZSBjb21wcmVzc2lvblxuLy8gTk9URTogVGhpcyBwbHVnaW4gc2hvdWxkIGJlIGxvYWRlZCBhdCBsYXN0IHRvIGVuc3VyZSB0aGF0IGFsbCBlbWl0dGVkIGltYWdlc1xuLy8gcmFuIHRocm91Z2guXG5wbHVnaW5JbnN0YW5jZXMucHVzaChuZXcgcGx1Z2lucy5JbWFnZW1pbihcbiAgICBjb25maWd1cmF0aW9uLm1vZHVsZS5vcHRpbWl6ZXIuaW1hZ2UuY29udGVudCkpXG4vLyAvLy8gZW5kcmVnaW9uXG4vLyAvLyBlbmRyZWdpb25cbi8vIC8gcmVnaW9uIGxvYWRlclxubGV0IGltYWdlTG9hZGVyOnN0cmluZyA9ICd1cmw/JyArIEpTT04uc3RyaW5naWZ5KFxuICAgIGNvbmZpZ3VyYXRpb24ubW9kdWxlLm9wdGltaXplci5pbWFnZS5maWxlKVxuY29uc3QgbG9hZGVyOntcbiAgICBwcmVwcm9jZXNzb3I6e1xuICAgICAgICBjYXNjYWRpbmdTdHlsZVNoZWV0OnN0cmluZztcbiAgICAgICAgbGVzczpzdHJpbmc7XG4gICAgICAgIHNhc3M6c3RyaW5nO1xuICAgICAgICBzY3NzOnN0cmluZztcbiAgICAgICAgamF2YVNjcmlwdDpzdHJpbmc7XG4gICAgICAgIGNvZmZlZTpzdHJpbmc7XG4gICAgICAgIHB1ZzpzdHJpbmc7XG4gICAgICAgIGxpdGVyYXRlQ29mZmVlOnN0cmluZ1xuICAgIH07XG4gICAgaHRtbDpzdHJpbmc7XG4gICAgY2FzY2FkaW5nU3R5bGVTaGVldDpzdHJpbmc7XG4gICAgc3R5bGU6c3RyaW5nO1xuICAgIHBvc3Rwcm9jZXNzb3I6e1xuICAgICAgICBpbWFnZTpzdHJpbmc7XG4gICAgICAgIGZvbnQ6e1xuICAgICAgICAgICAgZW90OnN0cmluZztcbiAgICAgICAgICAgIHdvZmY6c3RyaW5nO1xuICAgICAgICAgICAgdHRmOnN0cmluZztcbiAgICAgICAgICAgIHN2ZzpzdHJpbmdcbiAgICAgICAgfTtcbiAgICAgICAgZGF0YTpzdHJpbmdcbiAgICB9XG59ID0ge1xuICAgIHByZXByb2Nlc3Nvcjoge1xuICAgICAgICBjYXNjYWRpbmdTdHlsZVNoZWV0OiAncG9zdGNzcycsXG4gICAgICAgIGphdmFTY3JpcHQ6ICdiYWJlbD8nICsgSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uLm1vZHVsZS5wcmVwcm9jZXNzb3IubW9kZXJuSmF2YVNjcmlwdCksXG4gICAgICAgIHB1ZzogYHB1Zz8ke0pTT04uc3RyaW5naWZ5KGNvbmZpZ3VyYXRpb24ubW9kdWxlLnByZXByb2Nlc3Nvci5wdWcpfWAsXG4gICAgICAgIC8vIFRPRE8gZGVwcmVjYXRlZFxuICAgICAgICBjb2ZmZWU6ICdjb2ZmZWUnLFxuICAgICAgICBsaXRlcmF0ZUNvZmZlZTogJ2NvZmZlZT9saXRlcmF0ZScsXG4gICAgICAgIGxlc3M6IGBsZXNzPyR7SlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbi5tb2R1bGUucHJlcHJvY2Vzc29yLmxlc3MpfWAsXG4gICAgICAgIHNhc3M6IGBzYXNzPyR7SlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbi5tb2R1bGUucHJlcHJvY2Vzc29yLnNhc3MpfWAsXG4gICAgICAgIHNjc3M6IGBzYXNzPyR7SlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbi5tb2R1bGUucHJlcHJvY2Vzc29yLnNjc3MpfWBcbiAgICAgICAgLy9cbiAgICB9LFxuICAgIGh0bWw6IGBodG1sPyR7SlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbi5tb2R1bGUuaHRtbCl9YCxcbiAgICBjYXNjYWRpbmdTdHlsZVNoZWV0OiAnY3NzPycgKyBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgY29uZmlndXJhdGlvbi5tb2R1bGUuY2FzY2FkaW5nU3R5bGVTaGVldCksXG4gICAgc3R5bGU6IGBzdHlsZT8ke0pTT04uc3RyaW5naWZ5KGNvbmZpZ3VyYXRpb24ubW9kdWxlLnN0eWxlKX1gLFxuICAgIHBvc3Rwcm9jZXNzb3I6IHtcbiAgICAgICAgaW1hZ2U6IGltYWdlTG9hZGVyLFxuICAgICAgICBmb250OiB7XG4gICAgICAgICAgICBlb3Q6ICd1cmw/JyArIEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ubW9kdWxlLm9wdGltaXplci5mb250LmVvdCksXG4gICAgICAgICAgICB3b2ZmOiAndXJsPycgKyBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLm1vZHVsZS5vcHRpbWl6ZXIuZm9udC53b2ZmKSxcbiAgICAgICAgICAgIHR0ZjogJ3VybD8nICsgSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5tb2R1bGUub3B0aW1pemVyLmZvbnQudHRmKSxcbiAgICAgICAgICAgIHN2ZzogJ3VybD8nICsgSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5tb2R1bGUub3B0aW1pemVyLmZvbnQuc3ZnKVxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBgdXJsPyR7SlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbi5tb2R1bGUub3B0aW1pemVyLmRhdGEpfWBcbiAgICB9XG59XG4vLyAvIGVuZHJlZ2lvblxuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gY29uZmlndXJhdGlvblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIGNvbnRleHQ6IGNvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LFxuICAgIGRlYnVnOiBjb25maWd1cmF0aW9uLmRlYnVnLFxuICAgIGRldnRvb2w6IGNvbmZpZ3VyYXRpb24uZGV2ZWxvcG1lbnQudG9vbCxcbiAgICBkZXZzZXJ2ZXI6IGNvbmZpZ3VyYXRpb24uZGV2ZWxvcG1lbnQuc2VydmVyLFxuICAgIC8vIHJlZ2lvbiBpbnB1dFxuICAgIGVudHJ5OiBub3JtYWxpemVkSW50ZXJuYWxJbmplY3Rpb24sIGV4dGVybmFsczogaW5qZWN0aW9uLmV4dGVybmFsLFxuICAgIHJlc29sdmVMb2FkZXI6IGNvbmZpZ3VyYXRpb24ubG9hZGVyLFxuICAgIHJlc29sdmU6IHtcbiAgICAgICAgYWxpYXM6IGNvbmZpZ3VyYXRpb24ubW9kdWxlLmFsaWFzZXMsXG4gICAgICAgIGV4dGVuc2lvbnM6IGNvbmZpZ3VyYXRpb24ua25vd25FeHRlbnNpb25zLFxuICAgICAgICByb290OiBbKGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC5zb3VyY2U6IHN0cmluZyldXG4gICAgfSxcbiAgICAvLyBlbmRyZWdpb25cbiAgICAvLyByZWdpb24gb3V0cHV0XG4gICAgb3V0cHV0OiB7XG4gICAgICAgIGZpbGVuYW1lOiBjb25maWd1cmF0aW9uLmZpbGVzLmphdmFTY3JpcHQsXG4gICAgICAgIGhhc2hGdW5jdGlvbjogY29uZmlndXJhdGlvbi5oYXNoQWxnb3JpdGhtLFxuICAgICAgICBsaWJyYXJ5OiBsaWJyYXJ5TmFtZSxcbiAgICAgICAgbGlicmFyeVRhcmdldDogKFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbi5naXZlbkNvbW1hbmRMaW5lQXJndW1lbnRzWzJdID09PSAnYnVpbGRETEwnXG4gICAgICAgICkgPyAndmFyJyA6IGNvbmZpZ3VyYXRpb24uZXhwb3J0Rm9ybWF0LFxuICAgICAgICBwYXRoOiBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQudGFyZ2V0LFxuICAgICAgICAvLyBwdWJsaWNQYXRoOiBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQucHVibGljVGFyZ2V0LFxuICAgICAgICBwYXRoaW5mbzogY29uZmlndXJhdGlvbi5kZWJ1ZyxcbiAgICAgICAgdW1kTmFtZWREZWZpbmU6IHRydWVcbiAgICB9LFxuICAgIHRhcmdldDogY29uZmlndXJhdGlvbi50YXJnZXQsXG4gICAgLy8gZW5kcmVnaW9uXG4gICAgbW9kdWxlOiB7XG4gICAgICAgIG5vUGFyc2U6IGNvbmZpZ3VyYXRpb24ubW9kdWxlLnNraXBQYXJzZVJlZ3VsYXJFeHByZXNzaW9uLFxuICAgICAgICBwcmVMb2FkZXJzOiBbXG4gICAgICAgICAgICAvLyBDb252ZXJ0IHRvIG5hdGl2ZSB3ZWIgdHlwZXMuXG4gICAgICAgICAgICAvLyByZWdpb24gc2NyaXB0XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVzdDogL1xcLmpzJC8sXG4gICAgICAgICAgICAgICAgbG9hZGVyOiBsb2FkZXIucHJlcHJvY2Vzc29yLmphdmFTY3JpcHQsXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogW3BhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LnNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LmphdmFTY3JpcHRcbiAgICAgICAgICAgICAgICApXS5jb25jYXQobW9kdWxlTG9jYXRpb25zLmRpcmVjdG9yeVBhdGhzKSxcbiAgICAgICAgICAgICAgICBleGNsdWRlOiAoZmlsZVBhdGg6c3RyaW5nKTpib29sZWFuID0+XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlci5pc0ZpbGVQYXRoSW5Mb2NhdGlvbihmaWxlUGF0aC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgL14oLispKD86XFw/W14/XSopJC8sICckMSdcbiAgICAgICAgICAgICAgICAgICAgKSwgY29uZmlndXJhdGlvbi5wYXRoLmlnbm9yZSlcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvXFwuY29mZmVlJC8sXG4gICAgICAgICAgICAgICAgbG9hZGVyOiBsb2FkZXIucHJlcHJvY2Vzc29yLmNvZmZlZSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiBbcGF0aC5qb2luKFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuc291cmNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuY29mZmVlU2NyaXB0XG4gICAgICAgICAgICAgICAgKV0uY29uY2F0KG1vZHVsZUxvY2F0aW9ucy5kaXJlY3RvcnlQYXRocylcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvXFwuKD86Y29mZmVlXFwubWR8bGl0Y29mZmVlKSQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogbG9hZGVyLnByZXByb2Nlc3Nvci5saXRlcmF0ZUNvZmZlZSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiBbcGF0aC5qb2luKFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuc291cmNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGguYXNzZXQuY29mZmVlU2NyaXB0XG4gICAgICAgICAgICAgICAgKV0uY29uY2F0KG1vZHVsZUxvY2F0aW9ucy5kaXJlY3RvcnlQYXRocylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBlbmRyZWdpb25cbiAgICAgICAgICAgIC8vIHJlZ2lvbiBodG1sICh0ZW1wbGF0ZXMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVzdDogL1xcLnB1ZyQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjpcbiAgICAgICAgICAgICAgICAgICAgYGZpbGU/bmFtZT0ke2NvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC50ZW1wbGF0ZX1gICtcbiAgICAgICAgICAgICAgICAgICAgYFtuYW1lXS5odG1sPyR7Y29uZmlndXJhdGlvbi5oYXNoQWxnb3JpdGhtfT1baGFzaF0hYCArXG4gICAgICAgICAgICAgICAgICAgIGBleHRyYWN0ISR7bG9hZGVyLmh0bWx9ISR7bG9hZGVyLnByZXByb2Nlc3Nvci5wdWd9YCxcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiBwYXRoLmpvaW4oXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC5zb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC50ZW1wbGF0ZSksXG4gICAgICAgICAgICAgICAgZXhjbHVkZTogY29uZmlndXJhdGlvbi5maWxlcy5odG1sLm1hcCgoXG4gICAgICAgICAgICAgICAgICAgIGh0bWxDb25maWd1cmF0aW9uOkhUTUxDb25maWd1cmF0aW9uXG4gICAgICAgICAgICAgICAgKTpzdHJpbmcgPT4gaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUuc3Vic3RyaW5nKFxuICAgICAgICAgICAgICAgICAgICBodG1sQ29uZmlndXJhdGlvbi50ZW1wbGF0ZS5sYXN0SW5kZXhPZignIScpICsgMSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbmRyZWdpb25cbiAgICAgICAgXSxcbiAgICAgICAgbG9hZGVyczogW1xuICAgICAgICAgICAgLy8gTG9hZHMgZGVwZW5kZW5jaWVzLlxuICAgICAgICAgICAgLy8gcmVnaW9uIHN0eWxlXG4gICAgICAgICAgICAvLyBUT0RPIGRlcHJlY2F0ZWRcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvXFwubGVzcyQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogcGx1Z2lucy5FeHRyYWN0VGV4dC5leHRyYWN0KFxuICAgICAgICAgICAgICAgICAgICBsb2FkZXIuc3R5bGUsXG4gICAgICAgICAgICAgICAgICAgIGAke2xvYWRlci5jYXNjYWRpbmdTdHlsZVNoZWV0fSEke2xvYWRlci5wcmVwcm9jZXNzb3IubGVzc31gXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC5zYXNzJC8sXG4gICAgICAgICAgICAgICAgbG9hZGVyOiBwbHVnaW5zLkV4dHJhY3RUZXh0LmV4dHJhY3QoXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlci5zdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgYCR7bG9hZGVyLmNhc2NhZGluZ1N0eWxlU2hlZXR9ISR7bG9hZGVyLnByZXByb2Nlc3Nvci5zYXNzfWBcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdGVzdDogL1xcLnNjc3MkLyxcbiAgICAgICAgICAgICAgICBsb2FkZXI6IHBsdWdpbnMuRXh0cmFjdFRleHQuZXh0cmFjdChcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVyLnN0eWxlLFxuICAgICAgICAgICAgICAgICAgICBgJHtsb2FkZXIuY2FzY2FkaW5nU3R5bGVTaGVldH0hJHtsb2FkZXIucHJlcHJvY2Vzc29yLnNjc3N9YFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC5jc3MkLyxcbiAgICAgICAgICAgICAgICBsb2FkZXI6IHBsdWdpbnMuRXh0cmFjdFRleHQuZXh0cmFjdChcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVyLnN0eWxlLFxuICAgICAgICAgICAgICAgICAgICBgJHtsb2FkZXIucHJlcHJvY2Vzc29yLmNhc2NhZGluZ1N0eWxlU2hlZXR9IWAgK1xuICAgICAgICAgICAgICAgICAgICBsb2FkZXIuY2FzY2FkaW5nU3R5bGVTaGVldCksXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogW3BhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LnNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LmNhc2NhZGluZ1N0eWxlU2hlZXRcbiAgICAgICAgICAgICAgICApXS5jb25jYXQobW9kdWxlTG9jYXRpb25zLmRpcmVjdG9yeVBhdGhzKSxcbiAgICAgICAgICAgICAgICBleGNsdWRlOiAoZmlsZVBhdGg6c3RyaW5nKTpib29sZWFuID0+XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlci5pc0ZpbGVQYXRoSW5Mb2NhdGlvbihmaWxlUGF0aC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgL14oLispKD86XFw/W14/XSopJC8sICckMSdcbiAgICAgICAgICAgICAgICAgICAgKSwgY29uZmlndXJhdGlvbi5wYXRoLmlnbm9yZSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBlbmRyZWdpb25cbiAgICAgICAgICAgIC8vIHJlZ2lvbiBodG1sICh0ZW1wbGF0ZXMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVzdDogL1xcLmh0bWwkLyxcbiAgICAgICAgICAgICAgICBsb2FkZXI6XG4gICAgICAgICAgICAgICAgICAgIGBmaWxlP25hbWU9JHtjb25maWd1cmF0aW9uLnBhdGguYXNzZXQudGVtcGxhdGV9YCArXG4gICAgICAgICAgICAgICAgICAgIGBbbmFtZV0uW2V4dF0/JHtjb25maWd1cmF0aW9uLmhhc2hBbGdvcml0aG19PVtoYXNoXSFgICtcbiAgICAgICAgICAgICAgICAgICAgYGV4dHJhY3QhJHtsb2FkZXIuaHRtbH1gLFxuICAgICAgICAgICAgICAgIGluY2x1ZGU6IHBhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LnNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmFzc2V0LnRlbXBsYXRlKSxcbiAgICAgICAgICAgICAgICBleGNsdWRlOiBjb25maWd1cmF0aW9uLmZpbGVzLmh0bWwubWFwKChcbiAgICAgICAgICAgICAgICAgICAgaHRtbENvbmZpZ3VyYXRpb246SFRNTENvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgICAgICApOnN0cmluZyA9PiBodG1sQ29uZmlndXJhdGlvbi50ZW1wbGF0ZS5zdWJzdHJpbmcoXG4gICAgICAgICAgICAgICAgICAgIGh0bWxDb25maWd1cmF0aW9uLnRlbXBsYXRlLmxhc3RJbmRleE9mKCchJykgKyAxKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGVuZHJlZ2lvblxuICAgICAgICBdLFxuICAgICAgICBwb3N0TG9hZGVyczogW1xuICAgICAgICAgICAgLy8gT3B0aW1pemUgbG9hZGVkIGFzc2V0cy5cbiAgICAgICAgICAgIC8vIHJlZ2lvbiBmb250XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVzdDogL1xcLmVvdCg/OlxcP3Y9XFxkK1xcLlxcZCtcXC5cXGQrKT8kLyxcbiAgICAgICAgICAgICAgICBsb2FkZXI6IGxvYWRlci5wb3N0cHJvY2Vzc29yLmZvbnQuZW90XG4gICAgICAgICAgICB9LCB7dGVzdDogL1xcLndvZmYyPyQvLCBsb2FkZXI6IGxvYWRlci5wb3N0cHJvY2Vzc29yLmZvbnQud29mZn0sIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvXFwudHRmKD86XFw/dj1cXGQrXFwuXFxkK1xcLlxcZCspPyQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogbG9hZGVyLnBvc3Rwcm9jZXNzb3IuZm9udC50dGZcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvXFwuc3ZnKD86XFw/dj1cXGQrXFwuXFxkK1xcLlxcZCspPyQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogbG9hZGVyLnBvc3Rwcm9jZXNzb3IuZm9udC5zdmdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBlbmRyZWdpb25cbiAgICAgICAgICAgIC8vIHJlZ2lvbiBpbWFnZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC4oPzpwbmd8anBnfGljb3xnaWYpJC8sXG4gICAgICAgICAgICAgICAgbG9hZGVyOiBsb2FkZXIucG9zdHByb2Nlc3Nvci5pbWFnZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIGVuZHJlZ2lvblxuICAgICAgICAgICAgLy8gcmVnaW9uIGRhdGFcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZXN0OiAvLisvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogbG9hZGVyLnBvc3Rwcm9jZXNzb3IuZGF0YSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiBwYXRoLmpvaW4oXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC5zb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5hc3NldC5kYXRhKSxcbiAgICAgICAgICAgICAgICBleGNsdWRlOiAoZmlsZVBhdGg6c3RyaW5nKTpib29sZWFuID0+XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ua25vd25FeHRlbnNpb25zLmluY2x1ZGVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5leHRuYW1lKGZpbGVQYXRoLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgL14oLispKD86XFw/W14/XSopJC8sICckMScpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGVuZHJlZ2lvblxuICAgICAgICBdXG4gICAgfSxcbiAgICBwb3N0Y3NzOiAoKTpBcnJheTxPYmplY3Q+ID0+IFtcbiAgICAgICAgYXV0b3ByZWZpeGVyLCBwb3N0Y3NzSW1wb3J0KHthZGREZXBlbmRlbmN5VG86IHdlYnBhY2t9KVxuICAgIF0sXG4gICAgaHRtbDogY29uZmlndXJhdGlvbi5tb2R1bGUub3B0aW1pemVyLmh0bWxNaW5pZmllcixcbiAgICAvLyBMZXQgdGhlIFwiaHRtbC1sb2FkZXJcIiBhY2Nlc3MgZnVsbCBodG1sIG1pbmlmaWVyIHByb2Nlc3NpbmdcbiAgICAvLyBjb25maWd1cmF0aW9uLlxuICAgIHB1ZzogY29uZmlndXJhdGlvbi5tb2R1bGUucHJlcHJvY2Vzc29yLnB1ZyxcbiAgICBwbHVnaW5zOiBwbHVnaW5JbnN0YW5jZXNcbn1cbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIHZpbSBtb2RsaW5lXG4vLyB2aW06IHNldCB0YWJzdG9wPTQgc2hpZnR3aWR0aD00IGV4cGFuZHRhYjpcbi8vIHZpbTogZm9sZG1ldGhvZD1tYXJrZXIgZm9sZG1hcmtlcj1yZWdpb24sZW5kcmVnaW9uOlxuLy8gZW5kcmVnaW9uXG4iXX0=